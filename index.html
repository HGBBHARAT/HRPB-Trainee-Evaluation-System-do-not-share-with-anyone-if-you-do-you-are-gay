<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HRMC | Command Portal</title>
    <style>
        :root {
            --army-green: #2e3b23;
            --olive: #4b5d3f;
            --accent: #d4af37;
            --text: #f0f0f0;
            --danger: #8b0000;
            --success: #228b22;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #1a1a1a;
            color: var(--text);
            margin: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
        }

        /* Login Screen */
        #login-screen {
            background: var(--army-green);
            padding: 2rem;
            border-radius: 8px;
            border: 2px solid var(--accent);
            text-align: center;
        }

        input {
            padding: 10px;
            border-radius: 4px;
            border: none;
            margin: 10px 0;
        }

        button {
            background: var(--accent);
            color: black;
            font-weight: bold;
            padding: 10px 20px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            text-transform: uppercase;
        }

        /* Main Dashboard */
        #dashboard {
            display: none;
            width: 90%;
            max-width: 900px;
            background: #2a2a2a;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 0 20px rgba(0,0,0,0.5);
        }

        .tabs {
            display: flex;
            background: var(--army-green);
        }

        .tab {
            flex: 1;
            padding: 15px;
            text-align: center;
            cursor: pointer;
            border-bottom: 3px solid transparent;
        }

        .tab.active {
            border-bottom: 3px solid var(--accent);
            background: rgba(255,255,255,0.1);
        }

        .content {
            padding: 20px;
            display: none;
        }

        .content.active { display: block; }

        .form-group { margin-bottom: 15px; }
        label { display: block; margin-bottom: 5px; color: var(--accent); font-weight: bold; }
        
        .toggle-container {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 10px;
        }

        .trainee-card {
            background: #333;
            padding: 10px;
            margin: 10px 0;
            border-left: 4px solid var(--accent);
        }

        #publish-btn {
            background: var(--success);
            color: white;
            width: 100%;
            padding: 20px;
            font-size: 1.2rem;
            margin-top: 20px;
        }

        .summary-list {
            margin-top: 20px;
            border-top: 1px solid #444;
            padding-top: 10px;
        }
    </style>
</head>
<body>

    <div id="login-screen">
        <h2>HRMC SECURE ACCESS</h2>
        <input type="password" id="access-pass" placeholder="Enter Access Key">
        <br>
        <button onclick="checkPass()">Login</button>
    </div>

    <div id="dashboard">
        <div class="tabs">
            <div class="tab active" onclick="showTab('announce')">Announcements</div>
            <div class="tab" onclick="showTab('results')">Training Results</div>
        </div>

        <div id="announce" class="content active">
            <h3>Post Training Announcement</h3>
            <div class="form-group">
                <label>Trainer User ID</label>
                <input type="text" id="ann-uid" placeholder="1234567890...">
            </div>
            <div class="form-group">
                <label>Timezone</label>
                <input type="text" id="ann-tz" placeholder="e.g. EST">
            </div>
            <div class="form-group">
                <label>Local Time</label>
                <input type="text" id="ann-time" placeholder="e.g. 6:00 PM">
            </div>
            <div class="form-group">
                <label>Location</label>
                <input type="text" id="ann-loc" placeholder="Training Grounds">
            </div>
            <div class="form-group">
                <label>Additional Info</label>
                <textarea id="ann-info" style="width:100%; min-height:60px;"></textarea>
            </div>
            <button onclick="sendAnnounce()">Publish Announcement</button>
        </div>

        <div id="results" class="content">
            <h3>Multi-Trainee Evaluation Form</h3>
            <div style="display: flex; gap: 20px; border-bottom: 1px solid #444; padding-bottom: 15px;">
                <div class="form-group">
                    <label>Trainer Roblox Username</label>
                    <input type="text" id="res-host-rblx">
                </div>
                <div class="form-group">
                    <label>Trainer Discord ID</label>
                    <input type="text" id="res-host-id">
                </div>
            </div>

            <div id="trainee-input-area" style="margin-top:20px;">
                <label>Trainee Roblox Username</label>
                <input type="text" id="tr-rblx">
                <label>Trainee Discord ID</label>
                <input type="text" id="tr-id">
                
                <label>Knowledge Score (0-10)</label>
                <input type="number" id="tr-know" max="10" min="0">
                
                <label>Knowledge Notes</label>
                <textarea id="tr-know-notes" style="width:100%;"></textarea>

                <div class="mod-call-area">
                    <label>Mod-Call Section</label>
                    <div class="toggle-container">Proper SPAG: <input type="checkbox" id="tr-spag"></div>
                    <div class="toggle-container">Healed Trainer: <input type="checkbox" id="tr-heal"></div>
                    <div class="toggle-container">Punished Correctly: <input type="checkbox" id="tr-punish"></div>
                    <div class="toggle-container">Used Evidence: <input type="checkbox" id="tr-evid"></div>
                    <label>Mod-Call Notes</label>
                    <textarea id="tr-mod-notes" style="width:100%;"></textarea>
                </div>

                <div style="margin-top:15px; display:flex; gap:10px;">
                    <button onclick="addTrainee(false)" style="background:var(--olive); color:white;">Add Trainee</button>
                    <button onclick="addTrainee(true)" style="background:var(--danger); color:white;">Disqualify Trainee</button>
                </div>
            </div>

            <div class="summary-list" id="summary-list">
                </div>

            <button id="publish-btn" onclick="publishResults()">Publish Results</button>
        </div>
    </div>

    <script>
        const CONFIG = {
            WEBHOOK: "YOUR_WEBHOOK_URL_HERE",
            ANNOUNCE_ROLE: "YOUR_ROLE_ID_HERE",
            PASSWORD: "HRMC-X9-7721-OMEGA"
        };

        let traineeList = [];

        function checkPass() {
            const pass = document.getElementById('access-pass').value;
            if(pass === CONFIG.PASSWORD) {
                document.getElementById('login-screen').style.display = 'none';
                document.getElementById('dashboard').style.display = 'block';
            } else { alert("ACCESS DENIED"); }
        }

        function showTab(tabId) {
            document.querySelectorAll('.content').forEach(c => c.classList.remove('active'));
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            document.getElementById(tabId).classList.add('active');
            event.currentTarget.classList.add('active');
        }

        function sendAnnounce() {
            const uid = document.getElementById('ann-uid').value;
            const tz = document.getElementById('ann-tz').value;
            const time = document.getElementById('ann-time').value;
            const loc = document.getElementById('ann-loc').value;
            const info = document.getElementById('ann-info').value;

            const payload = {
                content: `<@${uid}> <@&${CONFIG.ANNOUNCE_ROLE}>`,
                embeds: [{
                    title: "⚔️ TRAINING BEING HOSTED",
                    color: 4541219,
                    fields: [
                        { name: "Curriculum", value: "Knowledge Section & Mod-Call Section", inline: false },
                        { name: "Post-Action", value: "Followed by an optional Voice Verification", inline: false },
                        { name: "When", value: `${time} ${tz}`, inline: true },
                        { name: "Where", value: loc, inline: true },
                        { name: "Additional Notes", value: info || "N/A" }
                    ],
                    footer: { text: "High Rock Military Corps" }
                }]
            };

            fetch(CONFIG.WEBHOOK, { method: 'POST', headers: {'Content-Type': 'application/json'}, body: JSON.stringify(payload) })
            .then(() => alert("Announcement Sent!"));
        }

        function addTrainee(isDQ) {
            if(traineeList.length >= 5) return alert("Max 5 trainees reached.");

            let dqReason = "";
            if(isDQ) { dqReason = prompt("Enter Disqualification Reason:"); if(!dqReason) return; }

            const knowScore = parseInt(document.getElementById('tr-know').value) || 0;
            const modScore = (document.getElementById('tr-spag').checked ? 2.5 : 0) +
                             (document.getElementById('tr-heal').checked ? 2.5 : 0) +
                             (document.getElementById('tr-punish').checked ? 2.5 : 0) +
                             (document.getElementById('tr-evid').checked ? 2.5 : 0);
            
            const total = knowScore + modScore;
            const status = isDQ ? "DISQUALIFIED" : (total >= 14 ? "PASS" : "FAIL");

            const trainee = {
                rblx: document.getElementById('tr-rblx').value,
                id: document.getElementById('tr-id').value,
                know: knowScore,
                knowNotes: document.getElementById('tr-know-notes').value,
                mod: modScore,
                modNotes: document.getElementById('tr-mod-notes').value,
                total: total,
                status: status,
                dqReason: dqReason,
                metrics: {
                    spag: document.getElementById('tr-spag').checked ? "Y" : "N",
                    heal: document.getElementById('tr-heal').checked ? "Y" : "N",
                    punish: document.getElementById('tr-punish').checked ? "Y" : "N",
                    evid: document.getElementById('tr-evid').checked ? "Y" : "N"
                }
            };

            traineeList.push(trainee);
            updateSummary();
            clearTraineeForm();
        }

        function updateSummary() {
            const list = document.getElementById('summary-list');
            list.innerHTML = "<h4>Current Batch:</h4>";
            traineeList.forEach((t, i) => {
                list.innerHTML += `<div class="trainee-card">Trainee ${i+1}: ${t.rblx} | Score: ${t.total}/20 | Status: ${t.status}</div>`;
            });
        }

        function clearTraineeForm() {
            ['tr-rblx', 'tr-id', 'tr-know', 'tr-know-notes', 'tr-mod-notes'].forEach(id => document.getElementById(id).value = "");
            ['tr-spag', 'tr-heal', 'tr-punish', 'tr-evid'].forEach(id => document.getElementById(id).checked = false);
        }

        async function publishResults() {
            const hostId = document.getElementById('res-host-id').value;
            const hostRblx = document.getElementById('res-host-rblx').value;
            
            let pings = `<@${hostId}> `;
            traineeList.forEach(t => pings += `<@${t.id}> `);

            const embeds = traineeList.map(t => ({
                title: `EVALUATION: ${t.status}`,
                color: t.status === "PASS" ? 3066993 : 15158332,
                fields: [
                    { name: "Host", value: `${hostRblx} (${hostId})`, inline: true },
                    { name: "Candidate", value: `${t.rblx} (${t.id})`, inline: true },
                    { name: "Final Score", value: `${t.total}/20`, inline: true },
                    { name: "Knowledge Section", value: `Score: ${t.know}/10\nNotes: ${t.knowNotes}`, inline: false },
                    { name: "Mod-Call Section", value: `SPAG: ${t.metrics.spag} | Healed: ${t.metrics.heal}\nPunish: ${t.metrics.punish} | Evidence: ${t.metrics.evid}\nNotes: ${t.modNotes}`, inline: false }
                ]
            }));

            if(t.dqReason) embeds[embeds.length-1].fields.push({name: "DQ Reason", value: t.dqReason});

            const payload = { content: pings, embeds: embeds };

            await fetch(CONFIG.WEBHOOK, { method: 'POST', headers: {'Content-Type': 'application/json'}, body: JSON.stringify(payload) });
            alert("Results Published!");
            traineeList = [];
            updateSummary();
        }
    </script>
</body>
</html>
